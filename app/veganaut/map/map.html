<div ng-class="{isAddingLocation: isAddingLocation}" ng-controller="MapCtrl">
    <div class="backdrop" ng-show="isAddingLocation"></div>
    <div class="pageSection">
        <button ng-hide="activeLocation" type="button" class="addLocation btn btn-block btnTeam"
         ng-click="startAddNewLocation()">
            <span class="glyphicon glyphicon-play"></span>
            <span ng-bind="'action.map.addLocation'|trans"></span>
        </button>
        <button ng-show="activeLocation" type="button" class="viewDetails btn btn-block btnTeam"
         ng-click="viewDetails(activeLocation)">
            <span class="glyphicon glyphicon-eye-open"></span>
            <span ng-bind="'action.map.viewDetails'|trans"></span>
        </button>
    </div>

    <leaflet class="mainMap pageSection" ng-class="{inFrontOfBackdrop: isAddingLocation}"
     markers="locations" defaults="mapSettings" center="center" event-broadcast="events">
    </leaflet>

    <div class="well pageSection inFrontOfBackdrop" ng-if="isAddingLocation">
        <form novalidate name="locationForm" class="locationForm spacedForm">
            <input type="text" required class="form-control" ng-model="newLocation.title"
             placeholder="{{ 'location.form.name' | trans }}"/>
            <select required class="form-control" ng-model="newLocation.type">
                <option value="">{{ 'location.form.chooseType' | trans }}</option>
                <option ng-repeat="type in locationTypes" value="{{ type }}">{{ 'location.type.' + type | trans }}</option>
            </select>
            <input type="hidden" required ng-model="newLocation.lat"/>
            <input type="hidden" required ng-model="newLocation.lng"/>
            <div ng-bind="'location.form.selectOnMap' | trans" ng-hide="newLocation.lat && newLocation.lng"></div>
            <button type="button" class="cancelAddLocation btn btn-default"
             ng-click="resetAddNewLocation()">
                <span class="glyphicon glyphicon-remove"></span>
                <span ng-bind="'action.cancel'|trans"></span>
            </button>
            <button type="submit" class="btn btn-default btnTeam pull-right"
             ng-disabled="locationForm.$invalid" ng-click="addNewLocation()">
                <span class="glyphicon glyphicon-ok"></span>
                <span ng-bind="'location.form.submit'|trans"></span>
            </button>
        </form>
    </div>

    <div class="well infoWell locationDetails" ng-show="activeLocation && !isAddingLocation">
        <div class="locationTitle">{{ activeLocation.title }}</div>
        <vg-location-type-badge location="activeLocation"></vg-location-type-badge>
        <vg-team-badge team="activeLocation.team"></vg-team-badge>
    </div>
</div>
